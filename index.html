<!doctype html>
<html lang="ru">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>‚ö° BBET Filter v6.0 ‚Äî Adaptive Jackpot Engine</title>
<style>
:root{
  --bg:#0f172a;--fg:#e2e8f0;--mut:#94a3b8;--line:#23314f;
  --accent:#2563eb;--accent-bright:#3b82f6;
  --good:#d8f5e3;--bad:#fde2e2;--neutral:#ffffff;--text:#111827;
}
html,body{margin:0;background:var(--bg);color:var(--fg);font:14px/1.4 system-ui,-apple-system,Segoe UI,Roboto,Arial}
header{padding:14px 16px;border-bottom:1px solid var(--line);font-weight:700}
main{max-width:1180px;margin:0 auto;padding:16px}

.row{display:flex;gap:10px;flex-wrap:wrap;align-items:center}
label{color:var(--mut)}
input[type=number]{background:#0b1427;border:1px solid var(--line);color:var(--fg);border-radius:8px;padding:6px 8px;width:90px}
.small{font-size:12px;color:var(--mut)}

/* –ö–∞—Ç–µ–≥–æ—Ä–∏—è: –∫–æ–º–ø–∞–∫—Ç–Ω—ã–π –≤—ã–¥–≤–∏–∂–Ω–æ–π –±–ª–æ–∫ */
.catWrap{position:relative}
.catToggle{background:#1e293b;border:1px solid var(--line);color:#e2e8f0;border-radius:8px;padding:8px 12px;cursor:pointer}
.catPanel{
  position:absolute;z-index:5;top:44px;left:0;background:#0b1427;border:1px solid var(--line);
  border-radius:10px;padding:10px 12px;min-width:260px;display:none;box-shadow:0 10px 24px rgba(0,0,0,.35)
}
.catPanel.open{display:block}
.catPanel .title{font-size:12px;color:#9fb3d9;margin-bottom:6px}
.catPanel .slider{display:flex;align-items:center;gap:10px}
input[type=range]{width:200px}

/* –ö–Ω–æ–ø–∫–∏ */
.btn{background:var(--accent);color:#fff;border:none;border-radius:8px;height:38px;padding:0 14px;cursor:pointer}
.btn.gray{background:#475569}
.btn:hover{background:var(--accent-bright)}

/* –¢–∞–±–ª–∏—Ü–∞ */
table{width:100%;border-collapse:collapse;margin-top:12px}
th,td{border:1px solid var(--line);padding:6px;text-align:center}
th:first-child,td:first-child{width:36px}
th.name,td.name{text-align:left}
td.pick{
  cursor:pointer;background:var(--neutral);color:var(--text);font-weight:600;user-select:none;position:relative;
  transition:background-color 0.3s ease,transform .15s ease, box-shadow .15s ease;
}
td.pick .main{font-size:16px;line-height:1}
td.pick .sub{font-size:11px;opacity:.85}
td.pick:hover{box-shadow:0 0 0 2px rgba(37,99,235,.15) inset}

/* –í—ã–±–æ—Ä: —è—Ä–∫–æ –≤–∏–¥–Ω–æ */
td.pick.active{
  background-color:var(--accent)!important;color:#fff!important;
  transform:scale(1.02);
  box-shadow:0 0 8px var(--accent-bright);
}
td.pick.active::after{content:"‚úÖ";position:absolute;top:4px;right:6px;font-size:12px}

/* –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –æ—Ü–µ–Ω–æ–∫ (–º—è–≥–∫–∞—è) */
td.good{background:var(--good)}
td.bad{background:var(--bad)}
td.neutral{background:#fff}

/* –ù–∏–∑ */
textarea{width:100%;min-height:120px;background:#0b1427;border:1px solid var(--line);color:#e2e8f0;border-radius:8px;padding:8px}
.stats{margin-top:6px;color:var(--mut)}
.status{margin-top:4px;color:var(--mut);font-size:12px}
</style>
</head>
<body>
<header>‚ö° BBET Filter v6.0 ‚Äî Adaptive Jackpot Engine</header>
<main>

<!-- –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å -->
<div class="row">
  <div class="catWrap">
    <button class="catToggle" id="catBtn">–ö–∞—Ç–µ–≥–æ—Ä–∏—è: <b id="catLabel">13</b> ‚ñæ</button>
    <div class="catPanel" id="catPanel">
      <div class="title">–í—ã–±–µ—Ä–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—é (9‚Äì15):</div>
      <div class="slider">
        <span>9</span>
        <input id="catRange" type="range" min="9" max="15" step="1" value="13">
        <span>15</span>
      </div>
      <div class="small">–ê–∫—Ç–∏–≤–Ω–∞: <b id="catNow">13</b>. –ü–æ—Å–ª–µ –≤—ã–±–æ—Ä–∞ –ø–∞–Ω–µ–ª—å –∑–∞–∫—Ä–æ–µ—Ç—Å—è.</div>
    </div>
  </div>

  <label>–°—Ç–∞–≤–∫–∞ –∑–∞ –∫—É–ø–æ–Ω (‚ÇΩ)
    <input id="stake" type="number" min="1" step="1" value="30">
  </label>

  <button class="btn gray" id="btnSync">üîÑ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Ç–∏—Ä–∞–∂ (–ë–∞–ª–±–µ—Ç)</button>
  <span class="small" id="syncHint">–ü–æ–∫–∞ –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ. –ó–∞–≤—Ç—Ä–∞ –ø–æ–¥–∫–ª—é—á–∏–º –ø–∞—Ä—Å–µ—Ä –ë–∞–ª–±–µ—Ç.</span>
</div>

<!-- –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π -->
<div class="row" style="margin-top:8px">
  <button class="btn" id="btnBuild">‚öôÔ∏è –°—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞—Ç—å –∫—É–ø–æ–Ω—ã</button>
  <button class="btn gray" id="btnCsv">üíæ –≠–∫—Å–ø–æ—Ä—Ç CSV</button>
  <button class="btn gray" id="btnClear">üßπ –û—á–∏—Å—Ç–∏—Ç—å</button>
</div>

<!-- –¢–∞–±–ª–∏—Ü–∞ -->
<table id="grid">
  <thead><tr><th>#</th><th class="name">–ú–∞—Ç—á</th><th>1</th><th>X</th><th>2</th></tr></thead>
  <tbody></tbody>
</table>

<textarea id="out" placeholder="–ö–∞–∂–¥–∞—è —Å—Ç—Ä–æ–∫–∞ ‚Äî –æ–¥–∏–Ω –∫—É–ø–æ–Ω. –§–æ—Ä–º–∞—Ç: 30; 2;2;2;2;..."></textarea>
<div class="stats" id="stats">–ö—É–ø–æ–Ω–æ–≤: 0 ‚Ä¢ –°—É–º–º–∞: 0 ‚ÇΩ</div>
<div class="status" id="status">–î–∞–Ω–Ω—ã–µ: –¥–µ–º–æ. –û–±–Ω–æ–≤–∏–º –ø–∞—Ä—Å–µ—Ä–æ–º –ë–∞–ª–±–µ—Ç.</div>

</main>

<script>
/* ======= –¥–µ–º–æ-–¥–∞–Ω–Ω—ã–µ (–≤–º–µ—Å—Ç–æ –ø–∞—Ä—Å–µ—Ä–∞, –ø–æ–¥–∫–ª—é—á–∏–º –∑–∞–≤—Ç—Ä–∞) ======= */
const demo = [
  {match:"Arsenal ‚Äî Chelsea", probs:[42,28,30]},
  {match:"Inter ‚Äî Milan", probs:[44,27,29]},
  {match:"PSG ‚Äî Lyon", probs:[59,24,17]},
  {match:"Real Madrid ‚Äî Betis", probs:[63,22,15]},
  {match:"Bayern ‚Äî Dortmund", probs:[48,26,26]},
  {match:"Liverpool ‚Äî Newcastle", probs:[51,25,24]},
  {match:"Juventus ‚Äî Napoli", probs:[46,29,25]},
  {match:"Ajax ‚Äî Feyenoord", probs:[40,29,31]},
  {match:"Benfica ‚Äî Porto", probs:[43,27,30]},
  {match:"Marseille ‚Äî Nice", probs:[37,32,31]},
  {match:"Celtic ‚Äî Rangers", probs:[41,30,29]},
  {match:"Atletico ‚Äî Sevilla", probs:[47,28,25]},
  {match:"Roma ‚Äî Lazio", probs:[39,33,28]},
  {match:"Monaco ‚Äî Lille", probs:[44,27,29]},
  {match:"Sporting ‚Äî Braga", probs:[45,28,27]}
];

/* ======= —Å–æ—Å—Ç–æ—è–Ω–∏–µ ======= */
let matches = JSON.parse(JSON.stringify(demo)); // [{match, probs[1,X,2]}]
let picks = Array.from({length:15}, ()=>({ '1':false,'X':false,'2':false })); // —Ñ–ª–∞–≥–∏ –≤—ã–±–æ—Ä–∞
let stake = 30;
let category = 13;

/* ======= UI ======= */
const tbody = document.querySelector('#grid tbody');
const el = id => document.getElementById(id);

function renderTable(){
  tbody.innerHTML='';
  matches.forEach((m, i)=>{
    const tr = document.createElement('tr');
    const tdIdx = document.createElement('td'); tdIdx.textContent = (i+1);
    const tdName= document.createElement('td'); tdName.className='name'; tdName.textContent = m.match;
    tr.appendChild(tdIdx); tr.appendChild(tdName);

    ['1','X','2'].forEach((lab, idx)=>{
      const td=document.createElement('td');
      const val=m.probs[idx];
      // –º—è–≥–∫–∞—è —Ñ–æ–Ω–æ–≤–∞—è –ø–æ–¥—Å–≤–µ—Ç–∫–∞ –ø–æ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
      let cls='neutral'; if(val>50) cls='good'; else if(val<25) cls='bad';
      td.className = `pick ${cls}` + (picks[i][lab] ? ' active' : '');
      td.title = `–ú–∞—Ç—á ${i+1}: ${m.match}\n–ò—Å—Ö–æ–¥ ${lab} ‚Äî ${val}%`;
      td.innerHTML = `<div class="main">${lab} ‚Äî ${val}%</div><div class="sub">${picks[i][lab]?'–≤—ã–±—Ä–∞–Ω–æ':''}</div>`;
      td.onclick = ()=>{ picks[i][lab] = !picks[i][lab]; renderTable(); updateStats(); };
      tr.appendChild(td);
    });

    tbody.appendChild(tr);
  });
}

function buildCoupons(){
  // —Å–æ–±–∏—Ä–∞–µ–º –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø–æ –º–∞—Ç—á—É: –µ—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –Ω–∞–∂–∞—Ç–æ ‚Äî –±–µ—Ä—ë–º –≤—Å–µ 3 (–∫–∞–∫ —Ç—ã —Ö–æ—Ç–µ–ª)
  const sets = picks.map(p=>{
    const selected = Object.entries(p).filter(([,v])=>v).map(([k])=>k);
    return selected.length ? selected : ['1','X','2'];
  });

  // –∫–æ–º–±–∏–Ω–∏—Ä—É–µ–º (–±–µ–∑ —Å–∏–º–≤–æ–ª–æ–≤ 1X/X2 ‚Äî —Ç–æ–ª—å–∫–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è —Å—Ç—Ä–æ–∫–∞ –∏–∑ 15 —Å–∏–º–≤–æ–ª–æ–≤)
  const HARD_LIMIT = 100000; // —á—Ç–æ–±—ã –Ω–µ —É–±–∏—Ç—å –±—Ä–∞—É–∑–µ—Ä
  let res = [[]];
  for(const s of sets){
    const next=[];
    for(const r of res){
      for(const v of s){
        next.push(r.concat(v));
        if(next.length>HARD_LIMIT){ res=next; break; }
      }
      if(next.length>HARD_LIMIT) break;
    }
    res = next;
    if(res.length>HARD_LIMIT) break;
  }

  // –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (—Ü–µ–ª–µ–≤–æ–µ —á–∏—Å–ª–æ –∫—É–ø–æ–Ω–æ–≤)
  const target = targetByCategory(category, res.length);
  const out = res.slice(0, target).map(row => `${stake}; ${row.join(';')}`).join('\n');

  el('out').value = out || '(–Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å ‚Äî —É–º–µ–Ω—å—à–∏—Ç–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è)';
  updateStats(res.slice(0, target).length);
}

function targetByCategory(cat, theoretical){
  // —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–¥ ‚Äú–∫–∞–∫ –Ω–∞ —Ç–æ—Ç–æ–±—Ä–∏—Ñ‚Äù (–º–æ–∂–µ–º –ø–æ–¥–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å)
  const map={15:5000,14:4000,13:12000,12:25000,11:50000,10:90000,9:150000};
  const t = map[cat] || 12000;
  return Math.min(theoretical, t);
}

function exportCsv(){
  const t=el('out').value.trim();
  if(!t){ alert('–°–Ω–∞—á–∞–ª–∞ —Å—Ñ–æ—Ä–º–∏—Ä—É–π –∫—É–ø–æ–Ω—ã'); return; }
  const blob=new Blob([t],{type:'text/csv;charset=utf-8'});
  const url=URL.createObjectURL(blob);
  const a=document.createElement('a'); a.href=url; a.download='bbet_coupons.csv'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
}

function updateStats(currentCount=0){
  const sum = currentCount * stake;
  el('stats').textContent = `–ö—É–ø–æ–Ω–æ–≤: ${currentCount.toLocaleString('ru-RU')} ‚Ä¢ –°—Ç–∞–≤–∫–∞: ${stake} ‚ÇΩ ‚Ä¢ –°—É–º–º–∞: ${sum.toLocaleString('ru-RU')} ‚ÇΩ ‚Ä¢ –ö–∞—Ç–µ–≥–æ—Ä–∏—è ${category}`;
}

/* ======= –ö–∞—Ç–µ–≥–æ—Ä–∏—è (–ø–æ–ª–∑—É–Ω–æ–∫) ======= */
(function(){
  const btn = el('catBtn');
  const panel = el('catPanel');
  const rng = el('catRange');
  const lab = el('catLabel');
  const now = el('catNow');
  btn.onclick = ()=> panel.classList.toggle('open');
  rng.addEventListener('input', ()=>{
    now.textContent = rng.value;
  });
  rng.addEventListener('change', ()=>{
    category = parseInt(rng.value,10);
    lab.textContent = category;
    panel.classList.remove('open');
    updateStats( (el('out').value.trim().length) ? el('out').value.trim().split('\n').length : 0 );
  });
})();

/* ======= –°—Ç–∞–≤–∫–∞ ======= */
el('stake').addEventListener('input', ()=>{
  const v = parseInt(el('stake').value,10);
  stake = Number.isFinite(v) && v>0 ? v : 30;
  // –ø–µ—Ä–µ—Å—á—ë—Ç —Å—É–º–º—ã –µ—Å–ª–∏ –∫—É–ø–æ–Ω—ã —É–∂–µ —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω—ã
  const lines = el('out').value.trim()? el('out').value.trim().split('\n').length : 0;
  updateStats(lines);
});

/* ======= –ó–∞–≥–ª—É—à–∫–∞ –ø–∞—Ä—Å–µ—Ä–∞ –ë–∞–ª–±–µ—Ç (–≤–∫—Ä—É—Ç–∏–º –∑–∞–≤—Ç—Ä–∞) ======= */
el('btnSync').onclick = ()=>{
  // —Ç—É—Ç –∑–∞–≤—Ç—Ä–∞ –ø–æ–¥–∫–ª—é—á–∏–º cookie + fetch HTML —Å –ë–∞–ª–±–µ—Ç –∏ —Ä–∞—Å–ø–∞—Ä—Å–∏–º —Å–ø–∏—Å–æ–∫ –º–∞—Ç—á–µ–π
  // —Å–µ–π—á–∞—Å –ø—Ä–æ—Å—Ç–æ –º—è–≥–∫–æ –ø–µ—Ä–µ—Ä–∏—Å—É–µ–º –¥–µ–º–æ –∏ –ø–æ–∫–∞–∂–µ–º —Å—Ç–∞—Ç—É—Å
  renderTable();
  el('status').textContent = '–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: –∑–∞–≥–ª—É—à–∫–∞ (–¥–µ–º–æ). –ì–æ—Ç–æ–≤ –∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—é –ø–∞—Ä—Å–µ—Ä–∞ –ë–∞–ª–±–µ—Ç.';
};

/* ======= –ö–Ω–æ–ø–∫–∏ ======= */
el('btnBuild').onclick = buildCoupons;
el('btnCsv').onclick   = exportCsv;
el('btnClear').onclick = ()=>{ picks = Array.from({length:15}, ()=>({ '1':false,'X':false,'2':false })); el('out').value=''; renderTable(); updateStats(0); };

/* ======= –°—Ç–∞—Ä—Ç ======= */
renderTable();
updateStats(0);
</script>
</body>
</html>
